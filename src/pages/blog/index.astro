---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';

const title = '블로그 - 주차 꿀팁 & 정보 | ParkingMap';
const description = '서울 주차장 이용 꿀팁, 무료주차장 정보, 주차 관련 유용한 글을 모아놓은 블로그입니다.';
const canonical = 'https://parkingmap.kr/blog/';

const breadcrumbs = [
  { name: '홈', url: 'https://parkingmap.kr/' },
  { name: '블로그', url: canonical },
];

// Content Collections 블로그 글 가져오기
const mdPosts = await getCollection('blog');
const allPosts = mdPosts.map((post) => ({
  slug: post.slug,
  title: post.data.title,
  description: post.data.description,
  date: post.data.date,
})).sort(
  (a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()
);
---

<BaseLayout title={title} description={description} canonical={canonical} breadcrumbs={breadcrumbs}>
  <Header />

  <div class="max-w-3xl mx-auto">
    <h1 class="text-3xl font-black text-gray-900 mb-2">블로그</h1>
    <p class="text-gray-500 mb-10">주차에 대한 유용한 정보와 꿀팁을 공유합니다.</p>

    <div class="space-y-6">
      {allPosts.map((post) => (
        <a href={`/blog/${post.slug}/`} class="block p-6 bg-white border border-gray-200 rounded-2xl hover:border-emerald-400 hover:shadow-md transition-all">
          <time class="text-sm text-gray-500">{post.date}</time>
          <h2 class="text-xl font-bold text-gray-900 mt-1 mb-2">{post.title}</h2>
          <p class="text-gray-500 text-sm">{post.description}</p>
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
