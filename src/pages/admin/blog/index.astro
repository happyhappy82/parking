---
export const prerender = false;
---
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex, nofollow" />
  <title>블로그 관리 | ParkingMap Admin</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; color: #111; }
    .sidebar {
      position: fixed; top: 0; left: 0; width: 240px; height: 100vh;
      background: #1a1a2e; color: white; padding: 24px 0;
    }
    .sidebar .logo { padding: 0 24px; font-size: 20px; font-weight: 800; margin-bottom: 32px; }
    .sidebar .logo span { color: #34d399; }
    .sidebar nav a {
      display: flex; align-items: center; gap: 10px;
      padding: 12px 24px; color: #aaa; text-decoration: none;
      font-size: 14px; transition: all 0.2s;
    }
    .sidebar nav a:hover, .sidebar nav a.active { color: white; background: rgba(255,255,255,0.08); }
    .sidebar nav a.active { border-left: 3px solid #34d399; }
    .main { margin-left: 240px; padding: 32px 40px; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
    .header h1 { font-size: 24px; font-weight: 800; }
    .btn { display: inline-block; padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none; }
    .btn-primary { background: #059669; color: white; }
    .btn-primary:hover { background: #047857; }
    .btn-sm { padding: 6px 12px; font-size: 13px; }
    .btn-gray { background: #e5e7eb; color: #374151; }
    .btn-gray:hover { background: #d1d5db; }
    .btn-red { background: #fee2e2; color: #dc2626; }
    .btn-red:hover { background: #fecaca; }
    .post-list { display: flex; flex-direction: column; gap: 12px; }
    .post-item {
      background: white; border-radius: 12px; padding: 20px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
      display: flex; justify-content: space-between; align-items: center;
    }
    .post-info h3 { font-size: 16px; font-weight: 700; margin-bottom: 4px; }
    .post-info p { font-size: 13px; color: #888; }
    .post-actions { display: flex; gap: 8px; }
    .badge {
      display: inline-block; padding: 2px 8px; border-radius: 4px;
      font-size: 11px; font-weight: 600; margin-left: 8px;
    }
    .badge-green { background: #d1fae5; color: #065f46; }
    .badge-blue { background: #dbeafe; color: #1e40af; }
    .loading { text-align: center; padding: 40px; color: #888; }
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="logo"><span>P</span> Admin</div>
    <nav>
      <a href="/admin/">대시보드</a>
      <a href="/admin/blog/" class="active">블로그 관리</a>
      <a href="/admin/parking/">주차장 관리</a>
      <a href="/" target="_blank">사이트 보기</a>
    </nav>
  </aside>

  <div class="main">
    <div class="header">
      <h1>블로그 관리</h1>
      <a href="/admin/blog/new/" class="btn btn-primary">새 글 작성</a>
    </div>

    <div id="postList" class="post-list">
      <div class="loading">불러오는 중...</div>
    </div>
  </div>

  <script is:inline>
    async function loadPosts() {
      const container = document.getElementById('postList');

      try {
        const res = await fetch('/api/admin/blog/');
        const data = await res.json();

        if (!data.posts || data.posts.length === 0) {
          container.innerHTML = '<div class="loading">블로그 글이 없습니다.</div>';
          return;
        }

        container.innerHTML = data.posts.map(post => `
          <div class="post-item">
            <div class="post-info">
              <h3>${post.title} <span class="badge ${post.source === 'md' ? 'badge-green' : 'badge-blue'}">${post.source === 'md' ? 'Markdown' : 'Legacy'}</span></h3>
              <p>${post.date} · ${post.slug}</p>
            </div>
            <div class="post-actions">
              <a href="/blog/${post.slug}/" target="_blank" class="btn btn-sm btn-gray">보기</a>
              ${post.source === 'md' ? `<a href="/admin/blog/edit/?slug=${post.slug}" class="btn btn-sm btn-primary">편집</a>` : ''}
            </div>
          </div>
        `).join('');
      } catch (e) {
        container.innerHTML = '<div class="loading">로드 실패: ' + e.message + '</div>';
      }
    }

    loadPosts();
  </script>
</body>
</html>
